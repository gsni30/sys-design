<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2382.3740691598036 1217.2026792033494" width="4764.748138319607" height="2434.4053584066987">
  <!-- svg-source:excalidraw -->
  
  <defs>
    <style class="style-fonts">
      @font-face {
        font-family: "Virgil";
        src: url("https://excalidraw.com/Virgil.woff2");
      }
      @font-face {
        font-family: "Cascadia";
        src: url("https://excalidraw.com/Cascadia.woff2");
      }
      @font-face {
        font-family: "Assistant";
        src: url("https://excalidraw.com/Assistant-Regular.woff2");
      }
    </style>
    
  </defs>
  <rect x="0" y="0" width="2382.3740691598036" height="1217.2026792033494" fill="#ffffff"></rect><g stroke-linecap="round" transform="translate(93 314.96229359117615) rotate(0 97 79)"><path d="M32 0 C74.11 -0.17, 118.51 0.43, 162 0 M32 0 C68.45 -1.72, 105.54 -0.46, 162 0 M162 0 C183.59 1.75, 195.41 11.62, 194 32 M162 0 C183.72 -2.14, 192.53 12.25, 194 32 M194 32 C193.66 54.36, 192.86 72.98, 194 126 M194 32 C194.58 63.93, 194.34 95.62, 194 126 M194 126 C194.83 145.49, 183.17 157.07, 162 158 M194 126 C192.67 146.62, 184.36 157.84, 162 158 M162 158 C130.51 158.68, 103.11 159.56, 32 158 M162 158 C122.57 159.36, 83 158.52, 32 158 M32 158 C12.66 157.98, 1.38 147.43, 0 126 M32 158 C10.51 155.87, -2.01 145.34, 0 126 M0 126 C1.28 105.79, -0.32 84.56, 0 32 M0 126 C-0.31 101.13, 0.72 77.17, 0 32 M0 32 C-0.92 9.28, 11.57 -0.79, 32 0 M0 32 C0.69 10.27, 9.73 -0.05, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(117.87007141113281 381.46229359117615) rotate(0 72.12992858886719 12.5)"><text x="72.12992858886719" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Clicker browser</text></g><g stroke-linecap="round" transform="translate(531 112.46229359117615) rotate(0 111.75 76)"><path d="M32 0 C86.69 -1.3, 142.04 -0.62, 191.5 0 M32 0 C74.11 -1.13, 116.36 -0.32, 191.5 0 M191.5 0 C213.45 -0.36, 223.53 9.48, 223.5 32 M191.5 0 C211.96 -0.03, 222.35 12.54, 223.5 32 M223.5 32 C223.69 66.79, 224.99 101.8, 223.5 120 M223.5 32 C222.7 62.63, 224.49 92.58, 223.5 120 M223.5 120 C223.13 141.03, 214.51 153.19, 191.5 152 M223.5 120 C224.3 142.44, 213.52 153.68, 191.5 152 M191.5 152 C156.86 153.36, 121.79 151.18, 32 152 M191.5 152 C155.8 152.6, 119.81 152.2, 32 152 M32 152 C11.42 153.24, -1.97 141.09, 0 120 M32 152 C10.94 150.92, 1.05 139.17, 0 120 M0 120 C0.8 95.31, -2.21 70.47, 0 32 M0 120 C0.18 89.3, -0.5 58.04, 0 32 M0 32 C-1.41 12.16, 9.19 1.2, 32 0 M0 32 C-1.16 9.11, 10.11 -0.17, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g stroke-linecap="round" transform="translate(89 119.96229359117615) rotate(0 94.5 56.75)"><path d="M28.38 0 C80.87 -0.08, 128.34 2.68, 160.63 0 M28.38 0 C58.41 1.87, 89.79 1.86, 160.63 0 M160.63 0 C178.77 0.29, 187.62 10.13, 189 28.38 M160.63 0 C181.12 -1.33, 190.42 9.92, 189 28.38 M189 28.38 C189.51 42.28, 189.18 53.27, 189 85.13 M189 28.38 C189.09 50.28, 189.2 71.23, 189 85.13 M189 85.13 C188.65 103.86, 178.38 113.41, 160.63 113.5 M189 85.13 C190.59 106.28, 181.62 113.3, 160.63 113.5 M160.63 113.5 C119.37 114.72, 74.48 112.52, 28.38 113.5 M160.63 113.5 C132.18 114.24, 101.84 115.26, 28.38 113.5 M28.38 113.5 C7.81 111.95, -1.65 104.11, 0 85.13 M28.38 113.5 C7.61 111.35, 0.23 103.39, 0 85.13 M0 85.13 C-1.79 65.15, -1.78 45.2, 0 28.38 M0 85.13 C-0.44 73.12, 0.93 60.45, 0 28.38 M0 28.38 C1.89 8.06, 8.67 -1.58, 28.38 0 M0 28.38 C-1.45 9.16, 11.58 0.93, 28.38 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(162.82001495361328 164.21229359117615) rotate(0 20.67998504638672 12.5)"><text x="20.67998504638672" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">CDN</text></g><g stroke-linecap="round" transform="translate(434.5 336.96229359117615) rotate(0 92 68)"><path d="M32 0 C70.98 -0.03, 108.19 0.34, 152 0 M32 0 C63.97 0.31, 95.15 0.34, 152 0 M152 0 C172.56 1.02, 185.28 10.21, 184 32 M152 0 C171.21 1.61, 183.78 9.24, 184 32 M184 32 C185.95 56.06, 182.6 80.07, 184 104 M184 32 C182.88 48.82, 184.14 64.8, 184 104 M184 104 C184.68 124.13, 173.97 136.33, 152 136 M184 104 C184.4 125.25, 174.05 135.24, 152 136 M152 136 C113.21 136.86, 76.52 135.35, 32 136 M152 136 C127.72 136.24, 103.41 137.22, 32 136 M32 136 C12.35 134.21, -0.37 125.78, 0 104 M32 136 C10.82 134.94, -0.71 127.51, 0 104 M0 104 C-0.13 85.13, -0.13 66.4, 0 32 M0 104 C1.25 81.39, 0.81 58.44, 0 32 M0 32 C-1.9 11.31, 10.13 -0.95, 32 0 M0 32 C0.29 9.08, 9.03 -0.47, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(471.03004455566406 392.46229359117615) rotate(0 55.46995544433594 12.5)"><text x="55.46995544433594" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">ad  service</text></g><g transform="translate(588.5 198.46229359117615) rotate(0 77.50993347167969 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">Analyst browser</text></g><g transform="translate(510 403.96229359117615) rotate(0 46.83995819091797 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">placement</text></g><g stroke-linecap="round" transform="translate(447.5 536.4622935911761) rotate(0 89.5 66.75)"><path d="M32 0 C74.57 -0.84, 114.68 0.7, 147 0 M32 0 C67.69 -0.66, 102.99 -0.79, 147 0 M147 0 C166.82 -1.94, 177.02 11.62, 179 32 M147 0 C167.63 -1.31, 180.53 10.5, 179 32 M179 32 C179.61 57.25, 179.14 85.21, 179 101.5 M179 32 C178.67 49.59, 179.32 65.96, 179 101.5 M179 101.5 C179.6 121.89, 166.4 133.55, 147 133.5 M179 101.5 C180.27 124.69, 169.97 132.31, 147 133.5 M147 133.5 C116.45 133.18, 86.45 133.4, 32 133.5 M147 133.5 C112.36 135.06, 76.32 134.14, 32 133.5 M32 133.5 C12.03 132.67, -0.73 123.13, 0 101.5 M32 133.5 C9.8 132.18, -1.85 122.54, 0 101.5 M0 101.5 C0.42 74.9, 0.34 49.52, 0 32 M0 101.5 C1.16 82.76, 0.69 61.81, 0 32 M0 32 C1.24 11.47, 10.96 -0.73, 32 0 M0 32 C1.67 12.41, 12.54 -1.5, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(469.55005645751953 578.2122935911761) rotate(0 67.44994354248047 25)"><text x="67.44994354248047" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">click capture </text><text x="67.44994354248047" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">service</text></g><g stroke-linecap="round"><g transform="translate(153 238.46229359117615) rotate(0 -1.75 39.5)"><path d="M-0.19 0 C-0.71 13.16, -1.96 67, -2.39 80.1 M-1.75 -1.04 C-2.39 12.32, -2.53 65.1, -2.75 78.56" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(153 238.46229359117615) rotate(0 -1.75 39.5)"><path d="M-11.08 54.99 C-7.84 65.35, -3.01 73.28, -2.75 78.56 M-11.08 54.99 C-8 61.65, -6.04 68.31, -2.75 78.56" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(153 238.46229359117615) rotate(0 -1.75 39.5)"><path d="M6.02 55.15 C3.1 65.43, 1.77 73.29, -2.75 78.56 M6.02 55.15 C4.54 61.71, 1.95 68.33, -2.75 78.56" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(194 312.96229359117615) rotate(0 -0.25 -37.75)"><path d="M1.18 -0.45 C0.92 -13.25, -1.45 -63, -1.6 -75.71 M0.34 -1.74 C0.44 -13.83, 0.6 -61.9, 0.54 -74.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(194 312.96229359117615) rotate(0 -0.25 -37.75)"><path d="M9.09 -50.79 C5.58 -59.53, 3.44 -63.37, 0.54 -74.28 M9.09 -50.79 C7.22 -55.07, 5.18 -60.51, 0.54 -74.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(194 312.96229359117615) rotate(0 -0.25 -37.75)"><path d="M-8.01 -50.78 C-6.43 -59.7, -3.47 -63.53, 0.54 -74.28 M-8.01 -50.78 C-6.46 -55.15, -5.08 -60.59, 0.54 -74.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(10 265.96229359117615) rotate(0 56.609947204589844 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">fetch image</text></g><g stroke-linecap="round"><g transform="translate(280 174.96229359117615) rotate(0 91 81.5)"><path d="M0.97 0.2 C31.56 27.35, 152.4 135.22, 182.46 162.4 M0.02 -0.74 C30.58 26.61, 151.72 136.04, 181.75 163.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(280 174.96229359117615) rotate(0 91 81.5)"><path d="M158.62 154.13 C163.8 156.72, 167.35 156.82, 181.75 163.62 M158.62 154.13 C166.59 156.83, 174.04 160.38, 181.75 163.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(280 174.96229359117615) rotate(0 91 81.5)"><path d="M170.13 141.48 C172.81 146.83, 173.93 149.6, 181.75 163.62 M170.13 141.48 C174.44 148.35, 178.18 155.97, 181.75 163.62" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(430 372.96229359117615) rotate(0 -77.25 -78)"><path d="M0.06 -0.55 C-25.38 -26.66, -127.99 -129.59, -153.73 -155.57 M-1.37 1.77 C-26.81 -24.18, -128.65 -131.28, -154.28 -157.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(430 372.96229359117615) rotate(0 -77.25 -78)"><path d="M-131.82 -146.48 C-137.55 -147.5, -140.63 -150.95, -154.28 -157.47 M-131.82 -146.48 C-137.18 -149.81, -144.33 -152.99, -154.28 -157.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(430 372.96229359117615) rotate(0 -77.25 -78)"><path d="M-144.14 -134.61 C-147.39 -138.13, -147.88 -144.07, -154.28 -157.47 M-144.14 -134.61 C-146.31 -141.06, -150.21 -147.36, -154.28 -157.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(314 148.46229359117615) rotate(0 115.47991180419922 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">generate ad on server/</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">client side</text></g><g stroke-linecap="round"><g transform="translate(288.5 377.46229359117615) rotate(0 74.5 8.5)"><path d="M1.19 0.44 C25.75 3.21, 123.22 14.61, 147.82 17.36 M0.35 -0.38 C25.22 1.96, 125.32 12.33, 149.91 15.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(288.5 377.46229359117615) rotate(0 74.5 8.5)"><path d="M125.6 21.29 C134.53 17.09, 142.63 16.67, 149.91 15.43 M125.6 21.29 C132.58 19.53, 139.3 18.42, 149.91 15.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(288.5 377.46229359117615) rotate(0 74.5 8.5)"><path d="M127.52 4.3 C135.89 5.87, 143.35 11.2, 149.91 15.43 M127.52 4.3 C133.8 7.56, 139.95 11.47, 149.91 15.43" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(427 419.46229359117615) rotate(0 -71.5 -9.75)"><path d="M0.34 -0.38 C-23.45 -3.61, -119.13 -16.96, -143.11 -20.18 M-0.94 -1.62 C-24.87 -4.63, -120.18 -16.19, -144.11 -19.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(427 419.46229359117615) rotate(0 -71.5 -9.75)"><path d="M-119.77 -24.7 C-127.06 -23.26, -134.19 -22.39, -144.11 -19.01 M-119.77 -24.7 C-127.6 -23.3, -133.06 -21.91, -144.11 -19.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(427 419.46229359117615) rotate(0 -71.5 -9.75)"><path d="M-121.8 -7.72 C-128.42 -10.91, -135 -14.65, -144.11 -19.01 M-121.8 -7.72 C-129.19 -11.13, -134.08 -14.54, -144.11 -19.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(309 430.46229359117615) rotate(0 56.299949645996094 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">uuid for ad</text></g><g stroke-linecap="round"><g transform="translate(271 472.96229359117615) rotate(0 90.75 38)"><path d="M1.18 1 C31.58 13.94, 151.89 64.5, 182.09 76.81 M0.34 0.48 C30.66 13.15, 151.16 62.6, 181.45 75.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(271 472.96229359117615) rotate(0 90.75 38)"><path d="M156.47 74.08 C164.98 75.1, 171.52 75.83, 181.45 75.12 M156.47 74.08 C161.9 73.92, 166.4 74.8, 181.45 75.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(271 472.96229359117615) rotate(0 90.75 38)"><path d="M162.98 58.26 C169.6 63.68, 174.35 68.76, 181.45 75.12 M162.98 58.26 C167.23 61.34, 170.39 65.45, 181.45 75.12" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(444.5 591.9622935911761) rotate(0 -115 -58.75)"><path d="M0.53 -0.09 C-37.6 -19.47, -190.57 -97, -228.95 -116.62 M-0.64 -1.18 C-38.84 -20.86, -191.06 -99.04, -229.35 -118.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(444.5 591.9622935911761) rotate(0 -115 -58.75)"><path d="M-204.54 -115.24 C-211.85 -114.26, -217.39 -116.46, -229.35 -118.27 M-204.54 -115.24 C-211 -115.2, -217.7 -117.85, -229.35 -118.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(444.5 591.9622935911761) rotate(0 -115 -58.75)"><path d="M-212.29 -100 C-217.32 -103.46, -220.62 -110.06, -229.35 -118.27 M-212.29 -100 C-216.59 -104.17, -221.15 -111.04, -229.35 -118.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(191.5 534.4622935911761) rotate(0 62.39994812011719 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">30x redirect</text></g><g stroke-linecap="round" transform="translate(684.0570924697954 557.8912274691411) rotate(0 142.83260237137551 40.49539715584058)"><path d="M20.25 0 C91.73 2, 163.1 1.95, 265.42 0 M20.25 0 C116.27 1.81, 211.63 0.92, 265.42 0 M265.42 0 C280.04 0.27, 284.36 7.48, 285.67 20.25 M265.42 0 C280.96 2.25, 286.17 8, 285.67 20.25 M285.67 20.25 C285.14 35.84, 284.92 50.01, 285.67 60.74 M285.67 20.25 C286.56 30.08, 285.47 38.16, 285.67 60.74 M285.67 60.74 C286.83 72.69, 277.23 81.36, 265.42 80.99 M285.67 60.74 C285.76 72.77, 276.69 78.96, 265.42 80.99 M265.42 80.99 C192.11 82.94, 121.05 83.07, 20.25 80.99 M265.42 80.99 C214.24 82.6, 164.59 82.11, 20.25 80.99 M20.25 80.99 C6.28 82, 0.66 73.95, 0 60.74 M20.25 80.99 C4.96 81.71, 0.48 74.95, 0 60.74 M0 60.74 C1.46 47.55, 1.57 36.26, 0 20.25 M0 60.74 C0.27 49.6, -0.05 39.92, 0 20.25 M0 20.25 C1.6 7.96, 8.08 0.13, 20.25 0 M0 20.25 C-0.6 8.29, 6.72 0.46, 20.25 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(763.6997534349209 585.8866246249818) rotate(0 63.18994140625 12.5)"><text x="63.18994140625" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">kafka/kinesis</text></g><g transform="translate(699.7529828402762 682.2026792033494) rotate(0 330.37969970703125 262.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">need a msg broker. becaue if there</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">is an outage on the db, there will be a back pressure</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">on the msg queue. and with such high volume, yu need </text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">to use a stream. kafka orders messages. generally used</text><text x="0" y="100" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">for pub sub.</text><text x="0" y="125" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">partitioning key: uuid</text><text x="0" y="150" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">sort key: timestamp</text><text x="0" y="175" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">partition on uuid of click instead of ad id to avoid hot partitions.</text><text x="0" y="200" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">problem with hot partition: higher read/write latency</text><text x="0" y="225" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">use consistent hashing for click uuid</text><text x="0" y="250" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="275" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">noisy neighbour problem</text><text x="0" y="300" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="325" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">influx db</text><text x="0" y="350" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">use cassandra or some kind of time series db</text><text x="0" y="375" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="400" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">partition key determines which partition the ad is going to fall in.</text><text x="0" y="425" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">sort key determines how the data is sorted within each partition.</text><text x="0" y="450" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="475" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">lmabda vs kappa architecture</text><text x="0" y="500" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">write heavy data store</text></g><g stroke-linecap="round"><g transform="translate(622.5292022175106 571.075775380345) rotate(0 32.019616355780954 1.2556712296384376)"><path d="M0.9 -1.16 C11.69 -0.72, 53.72 2.8, 64.18 3.35 M-0.08 0.84 C10.6 0.89, 52.84 1.27, 63.31 1.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(622.5292022175106 571.075775380345) rotate(0 32.019616355780954 1.2556712296384376)"><path d="M39.64 9.72 C43.73 7.72, 53.13 4.83, 63.31 1.67 M39.64 9.72 C46.06 7.59, 52.43 4.53, 63.31 1.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(622.5292022175106 571.075775380345) rotate(0 32.019616355780954 1.2556712296384376)"><path d="M40.01 -7.38 C44.1 -4.99, 53.41 -3.5, 63.31 1.67 M40.01 -7.38 C46.26 -4.88, 52.53 -3.3, 63.31 1.67" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(685.9405993142532 609.3737478843182) rotate(0 -32.33353416319051 0)"><path d="M-1.04 1.06 C-11.84 1.03, -53.4 -0.07, -64.02 -0.32 M0.62 0.58 C-10.35 0.72, -53.6 1.03, -64.63 1.06" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(685.9405993142532 609.3737478843182) rotate(0 -32.33353416319051 0)"><path d="M-41.18 -7.61 C-47.98 -3.57, -58.85 -1.58, -64.63 1.06 M-41.18 -7.61 C-48.08 -5.18, -54.23 -3.09, -64.63 1.06" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(685.9405993142532 609.3737478843182) rotate(0 -32.33353416319051 0)"><path d="M-41.09 9.49 C-47.92 7.28, -58.82 3.02, -64.63 1.06 M-41.09 9.49 C-47.91 7.34, -54.09 4.86, -64.63 1.06" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(307.9835591930748 653.9500765364837) rotate(0 135.60989379882812 37.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">once it is stored in kafka, </text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">then click capture will send</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">the redirect</text></g><g transform="translate(107.07616245092032 725.523336625876) rotate(0 272.5697937011719 112.49999999999989)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">request:</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">{</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    uuid (for ensuring you are not double charging),    </text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    ad_id,</text><text x="0" y="100" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    timestamp,</text><text x="0" y="125" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    user_metadata</text><text x="0" y="150" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    </text><text x="0" y="175" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">}</text><text x="0" y="200" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text></g><g stroke-linecap="round" transform="translate(724.4478501569158 324.12708185642623) rotate(0 63.72531490415213 67.5)"><path d="M31.86 0 C52.22 -0.73, 73.3 1.79, 95.59 0 M31.86 0 C52.1 -0.15, 72.52 -0.56, 95.59 0 M95.59 0 C115.52 -1.86, 128.83 12.47, 127.45 31.86 M95.59 0 C118.88 0.12, 125.19 8.81, 127.45 31.86 M127.45 31.86 C125.88 51.07, 128.34 70.18, 127.45 103.14 M127.45 31.86 C128.5 58.34, 127.21 84.68, 127.45 103.14 M127.45 103.14 C128.83 123.48, 116.62 135.04, 95.59 135 M127.45 103.14 C128.09 124.93, 115.31 135.18, 95.59 135 M95.59 135 C77.6 133.22, 61.65 135.02, 31.86 135 M95.59 135 C73.17 135.01, 51.08 134.55, 31.86 135 M31.86 135 C11.1 133.1, 1.35 122.56, 0 103.14 M31.86 135 C9.77 136.96, 0.61 123.44, 0 103.14 M0 103.14 C1.28 84.14, 0 68.58, 0 31.86 M0 103.14 C-0.78 78.48, 0.27 56.04, 0 31.86 M0 31.86 C0.96 11.69, 12.26 -0.05, 31.86 0 M0 31.86 C1.01 12.24, 11.54 1.43, 31.86 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(760.043183066439 329.12708185642623) rotate(0 28.129981994628906 62.5)"><text x="28.129981994628906" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">ad db</text><text x="28.129981994628906" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">{</text><text x="28.129981994628906" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">ad id,</text><text x="28.129981994628906" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">url</text><text x="28.129981994628906" y="100" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">}</text></g><g transform="translate(855.0376580393163 233.7187533224569) rotate(0 189.369873046875 37.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">click capture service can query ad db</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">or at the time of ad load, embed url </text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">in ad.</text></g><g stroke-linecap="round" transform="translate(1131.9131641745978 506.61796473575464) rotate(0 114.89391751191965 72.20109570421175)"><path d="M32 0 C66.27 -0.58, 99.31 1.92, 197.79 0 M32 0 C73.67 0.4, 117.35 0.15, 197.79 0 M197.79 0 C217.31 -0.84, 228.44 8.67, 229.79 32 M197.79 0 C218.22 -1.38, 229.74 8.74, 229.79 32 M229.79 32 C228.85 50.72, 228.77 68.45, 229.79 112.4 M229.79 32 C230.09 57.26, 230 83.43, 229.79 112.4 M229.79 112.4 C229.96 134.92, 218.19 143.81, 197.79 144.4 M229.79 112.4 C228.88 135.65, 220.69 142.64, 197.79 144.4 M197.79 144.4 C134.35 144.42, 67.85 142.54, 32 144.4 M197.79 144.4 C132.78 144.84, 67.17 144.13, 32 144.4 M32 144.4 C10.16 143.21, -1.87 131.77, 0 112.4 M32 144.4 C12.55 144.85, 0.04 132.04, 0 112.4 M0 112.4 C-0.99 95.37, 2.03 75.41, 0 32 M0 112.4 C-0.04 86.05, 1.35 61.62, 0 32 M0 32 C-0.12 11.21, 10.48 -0.66, 32 0 M0 32 C-1.25 10.84, 9.53 0.24, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1157.0471405854432 553.8190604399665) rotate(0 89.75994110107422 25)"><text x="89.75994110107422" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">ad capture data </text><text x="89.75994110107422" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">store</text></g><g stroke-linecap="round" transform="translate(1444.7845978532878 275.5744584822769) rotate(0 117.40525997119653 101.0815339858965)"><path d="M32 0 C89.88 2.18, 146.96 -0.21, 202.81 0 M32 0 C73.67 -1.77, 113.9 -1.26, 202.81 0 M202.81 0 C223.5 -0.3, 234.53 10.73, 234.81 32 M202.81 0 C224.67 0.68, 235.37 9.58, 234.81 32 M234.81 32 C233.32 73.88, 234.52 116.96, 234.81 170.16 M234.81 32 C234.75 70.46, 234.98 108, 234.81 170.16 M234.81 170.16 C233.28 192.89, 225.99 200.66, 202.81 202.16 M234.81 170.16 C233.74 191.76, 222.72 200.71, 202.81 202.16 M202.81 202.16 C150.13 202.62, 95.71 201.3, 32 202.16 M202.81 202.16 C163.14 202.6, 124.3 202.46, 32 202.16 M32 202.16 C9.56 201.11, 0.04 192.95, 0 170.16 M32 202.16 C12.4 202.28, -2.24 191.47, 0 170.16 M0 170.16 C1.33 140.93, -0.41 109.83, 0 32 M0 170.16 C0.35 115.91, 0.33 62.14, 0 32 M0 32 C1.51 12.64, 10.8 -1.01, 32 0 M0 32 C1.51 11.68, 11.16 -2.01, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1532.6815839279802 365.98278701624645) rotate(0 85.10992431640625 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">aggregated clicks</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">data store</text></g><g transform="translate(1758.074569648085 289.38684200829994) rotate(0 307.1497497558594 312.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">{</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    ad_id,</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    rounded down timestamp,</text><text x="0" y="75" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    count: 123</text><text x="0" y="100" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">    </text><text x="0" y="125" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">}</text><text x="0" y="150" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">postgres/</text><text x="0" y="175" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">dynamodb for sharding because you are geting a lot of writes</text><text x="0" y="200" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">partition on ad_id despite scatter gather issue</text><text x="0" y="225" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">scatter gather issue for reads but that's okay</text><text x="0" y="250" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="275" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">also let's say theer are 2million different ads</text><text x="0" y="300" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">and we won;t be wrtiting 2 million ads / s.</text><text x="0" y="325" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">also, scatter gather won't be a problem while writing </text><text x="0" y="350" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">because we are not querying for each ad and then writing.</text><text x="0" y="375" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="400" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">need to take care of straggler</text><text x="0" y="425" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">events. so aggregate over 2-3 min window evry time</text><text x="0" y="450" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">and it shoudl resolve itself</text><text x="0" y="475" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="500" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">10TPS reads from analyst browser</text><text x="0" y="525" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">3000 TPS for writes (initially 60k TPS but</text><text x="0" y="550" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">a lot of writes happened in the last second)</text><text x="0" y="575" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text><text x="0" y="600" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge"></text></g><g stroke-linecap="round" transform="translate(1485.5939128165378 511.6406496543084) rotate(0 103.27895863776394 72.82893131903108)"><path d="M32 0 C72.31 0.15, 113.31 0.72, 174.56 0 M32 0 C75.86 0.22, 117.36 0.36, 174.56 0 M174.56 0 C196.92 0.06, 208.25 10.77, 206.56 32 M174.56 0 C194.57 0.07, 208.77 10.93, 206.56 32 M206.56 32 C205.7 50.52, 205.24 67.18, 206.56 113.66 M206.56 32 C207.71 61.06, 206.53 90.29, 206.56 113.66 M206.56 113.66 C204.81 134.78, 197.86 146.18, 174.56 145.66 M206.56 113.66 C206.69 135.13, 197.66 147.74, 174.56 145.66 M174.56 145.66 C138.39 144.62, 103.18 145.33, 32 145.66 M174.56 145.66 C140.87 144, 106.41 144.32, 32 145.66 M32 145.66 C11.4 147.64, 0.74 134.01, 0 113.66 M32 145.66 C12.77 146.32, 1.01 136.48, 0 113.66 M0 113.66 C-1.08 95.28, 0.28 78.92, 0 32 M0 113.66 C0.63 94.18, 1.75 72.12, 0 32 M0 32 C-0.81 11.51, 12.39 1.92, 32 0 M0 32 C1.05 9.22, 10.92 -0.25, 32 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1542.099118150269 545.5437728545471) rotate(0 96.60991668701172 37.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">map/reduce</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">cron job </text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">which runs every min</text></g><g stroke-linecap="round"><g transform="translate(1483.71040597208 554.9613070768355) rotate(0 -64.6670683263809 0.941753422228885)"><path d="M0.44 0.86 C-20.92 1.12, -107.33 0.52, -128.91 0.82 M-0.78 0.27 C-22.21 0.71, -108.17 1.73, -129.63 1.8" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1483.71040597208 554.9613070768355) rotate(0 -64.6670683263809 0.941753422228885)"><path d="M-106.21 -6.95 C-110.47 -4.05, -119.31 -2.08, -129.63 1.8 M-106.21 -6.95 C-113.63 -4.46, -123.25 -0.66, -129.63 1.8" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1483.71040597208 554.9613070768355) rotate(0 -64.6670683263809 0.941753422228885)"><path d="M-106.07 10.15 C-110.25 8.94, -119.13 6.79, -129.63 1.8 M-106.07 10.15 C-113.7 6.44, -123.37 4.03, -129.63 1.8" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1364.421639156426 593.887115195628) rotate(0 58.70262998559838 0.9417534222287713)"><path d="M1.11 0.64 C20.45 0.98, 97.36 2.53, 116.61 2.9 M0.24 -0.07 C19.91 -0.11, 99.09 1.13, 118.9 1.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1364.421639156426 593.887115195628) rotate(0 58.70262998559838 0.9417534222287713)"><path d="M95.3 9.56 C104.54 5.13, 113.4 2.23, 118.9 1.3 M95.3 9.56 C103.99 6.43, 113.52 2.48, 118.9 1.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1364.421639156426 593.887115195628) rotate(0 58.70262998559838 0.9417534222287713)"><path d="M95.51 -7.54 C104.79 -6, 113.58 -2.94, 118.9 1.3 M95.51 -7.54 C104.2 -4.22, 113.65 -1.71, 118.9 1.3" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1015.3450394125598 534.2427317878007) rotate(0 33.27528758541939 38.297972503973256)"><path d="M16.64 0 C21.91 1.74, 31.03 1.9, 49.91 0 M16.64 0 C26.57 -0.12, 35.7 0.85, 49.91 0 M49.91 0 C59.22 -1.37, 66.51 5.92, 66.55 16.64 M49.91 0 C62.25 1.93, 68.15 6.49, 66.55 16.64 M66.55 16.64 C68.1 34.45, 67.96 48.63, 66.55 59.96 M66.55 16.64 C66.83 28.12, 66.09 39.9, 66.55 59.96 M66.55 59.96 C67.35 72.01, 60.74 76.54, 49.91 76.6 M66.55 59.96 C64.33 72.04, 60.88 75.24, 49.91 76.6 M49.91 76.6 C38.14 74.77, 25.57 77.79, 16.64 76.6 M49.91 76.6 C42.44 77.17, 35.25 76.25, 16.64 76.6 M16.64 76.6 C5.02 77.15, 1.3 69.7, 0 59.96 M16.64 76.6 C7.54 77.67, -0.53 70.93, 0 59.96 M0 59.96 C0.91 48.7, 0.08 39.42, 0 16.64 M0 59.96 C-0.31 51.45, -0.66 40.56, 0 16.64 M0 16.64 C1.71 4.71, 4.65 1.66, 16.64 0 M0 16.64 C-1.97 3.95, 6.88 -1.75, 16.64 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1022.2203483602839 547.5407042917741) rotate(0 26.399978637695312 25)"><text x="26.399978637695312" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">lambd</text><text x="26.399978637695312" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">a</text></g><g stroke-linecap="round"><g transform="translate(1086.9182995019523 566.8901837584008) rotate(0 22.915999940901997 -1.8835068444576564)"><path d="M-0.36 -0.51 C7.33 -1.11, 38.12 -3.32, 45.81 -3.91 M0.45 0.42 C8.11 -0.08, 37.87 -2.61, 45.37 -3.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1086.9182995019523 566.8901837584008) rotate(0 22.915999940901997 -1.8835068444576564)"><path d="M24.53 6.42 C28.5 4.18, 34.04 1.94, 45.37 -3.28 M24.53 6.42 C29.21 3.55, 35.08 1.65, 45.37 -3.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1086.9182995019523 566.8901837584008) rotate(0 22.915999940901997 -1.8835068444576564)"><path d="M23.17 -9.25 C27.42 -7.82, 33.27 -6.4, 45.37 -3.28 M23.17 -9.25 C28.23 -8.28, 34.43 -6.34, 45.37 -3.28" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(973.2800532196711 588.2365946622549) rotate(0 22.28816432608278 -4.7087671111443115)"><path d="M-0.33 -0.54 C7.06 -1.98, 36.54 -7.68, 44.07 -9.09 M0.51 0.38 C8.08 -1.18, 37.68 -8.19, 45.04 -9.88" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(973.2800532196711 588.2365946622549) rotate(0 22.28816432608278 -4.7087671111443115)"><path d="M25.96 2.57 C29.88 -1.46, 36.3 -3.21, 45.04 -9.88 M25.96 2.57 C33.37 -2.66, 40.55 -7.41, 45.04 -9.88" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(973.2800532196711 588.2365946622549) rotate(0 22.28816432608278 -4.7087671111443115)"><path d="M22.42 -12.6 C27.17 -12.77, 34.49 -10.67, 45.04 -9.88 M22.42 -12.6 C31.26 -11.99, 39.81 -10.9, 45.04 -9.88" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1569.0960462943672 507.0365241075119) rotate(0 -3.1391780740962076 -13.81238352602304)"><path d="M-0.46 0.5 C-1.4 -4.06, -4.87 -22.6, -5.78 -27.34 M0.3 0.28 C-0.66 -4.45, -4.89 -23.52, -5.96 -28.16" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1569.0960462943672 507.0365241075119) rotate(0 -3.1391780740962076 -13.81238352602304)"><path d="M1.69 -16.24 C0.24 -18.88, -2.12 -22.33, -5.96 -28.16 M1.69 -16.24 C0.18 -18.8, -1.97 -22.01, -5.96 -28.16" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1569.0960462943672 507.0365241075119) rotate(0 -3.1391780740962076 -13.81238352602304)"><path d="M-7.76 -14.11 C-6.64 -17.3, -6.42 -21.32, -5.96 -28.16 M-7.76 -14.11 C-7 -17.19, -6.88 -20.91, -5.96 -28.16" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(827.4129194279285 555.3798724361002) rotate(0 222.56772545341812 -31.705698548371288)"><path d="M-0.21 1.18 C73.81 -9.34, 370.77 -52.82, 445.07 -63.47 M-1.77 0.76 C72 -9.54, 369.62 -51.05, 444.09 -61.97" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(827.4129194279285 555.3798724361002) rotate(0 222.56772545341812 -31.705698548371288)"><path d="M422.03 -50.19 C432.42 -54.74, 438.74 -58.41, 444.09 -61.97 M422.03 -50.19 C430.35 -54.27, 437.38 -58.29, 444.09 -61.97" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(827.4129194279285 555.3798724361002) rotate(0 222.56772545341812 -31.705698548371288)"><path d="M419.62 -67.12 C430.88 -65.23, 438.11 -62.46, 444.09 -61.97 M419.62 -67.12 C428.7 -65.16, 436.6 -63.15, 444.09 -61.97" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(917.821247961898 458.6931877539382) rotate(0 118.97989654541016 25)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">reconcile from kafka for</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">straggler events</text></g><g stroke-linecap="round" transform="translate(1040.2491847685137 52.274268722833085) rotate(0 155.70323247516978 56.819123141140494)"><path d="M28.41 0 C110.01 -3.29, 189.85 -0.67, 283 0 M28.41 0 C97.96 -2.57, 167.64 -1.47, 283 0 M283 0 C301.6 1.99, 309.71 10.82, 311.41 28.41 M283 0 C304.06 0.46, 312.89 10.89, 311.41 28.41 M311.41 28.41 C309.68 42.17, 309.93 54.72, 311.41 85.23 M311.41 28.41 C312.19 45.44, 312.14 63.35, 311.41 85.23 M311.41 85.23 C313.32 102.54, 301.77 113.73, 283 113.64 M311.41 85.23 C311.12 103.96, 300.68 111.89, 283 113.64 M283 113.64 C195.09 114.9, 104.33 114.38, 28.41 113.64 M283 113.64 C184.11 114.91, 85.51 114.42, 28.41 113.64 M28.41 113.64 C9.17 112.6, 0.3 102.42, 0 85.23 M28.41 113.64 C10.78 113.32, 0.23 103.81, 0 85.23 M0 85.23 C1.33 69.96, 1.83 57.84, 0 28.41 M0 85.23 C0.01 71.82, -0.16 59.5, 0 28.41 M0 28.41 C1.06 11.45, 10.16 -0.59, 28.41 0 M0 28.41 C0.93 10.9, 10.09 2, 28.41 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1139.4472119099526 88.06089876752935) rotate(0 74.51993560791016 12.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">analyst servcie</text></g><g stroke-linecap="round"><g transform="translate(760.2345005591358 151.47229586427193) rotate(0 144.40219140842362 -22.28816432608278)"><path d="M-0.2 0.88 C47.95 -6.64, 240.45 -36.25, 288.45 -43.97 M-1.76 0.29 C46.24 -7.07, 238.66 -38.29, 287.32 -45.77" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(760.2345005591358 151.47229586427193) rotate(0 144.40219140842362 -22.28816432608278)"><path d="M265.45 -33.65 C272.55 -37.39, 277.87 -41.64, 287.32 -45.77 M265.45 -33.65 C270.3 -36.78, 275.28 -39.84, 287.32 -45.77" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(760.2345005591358 151.47229586427193) rotate(0 144.40219140842362 -22.28816432608278)"><path d="M262.77 -50.54 C270.74 -49.83, 276.76 -49.63, 287.32 -45.77 M262.77 -50.54 C268.14 -49.79, 273.73 -48.99, 287.32 -45.77" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1035.854335464779 133.26506303451401) rotate(0 -141.2630133343274 25.11342459276932)"><path d="M-0.3 -0.99 C-47.27 7.37, -234.44 40.88, -281.63 49.25 M1.74 1.11 C-45.32 9.66, -234.98 42.12, -282.1 50.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1035.854335464779 133.26506303451401) rotate(0 -141.2630133343274 25.11342459276932)"><path d="M-260.4 37.86 C-269 43.23, -275.84 44.14, -282.1 50.27 M-260.4 37.86 C-265.46 41.09, -269 43.96, -282.1 50.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1035.854335464779 133.26506303451401) rotate(0 -141.2630133343274 25.11342459276932)"><path d="M-257.5 54.71 C-266.89 54.75, -274.65 50.34, -282.1 50.27 M-257.5 54.71 C-263.21 54.3, -267.37 53.54, -282.1 50.27" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1347.8886360299377 87.43306315271002) rotate(0 128.7063010379428 95.11709564511375)"><path d="M0.31 -0.11 C43.22 31.67, 213.77 159.27, 256.73 191.07 M-0.99 -1.22 C42.38 30.2, 215.98 157.76, 259.08 189.38" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1347.8886360299377 87.43306315271002) rotate(0 128.7063010379428 95.11709564511375)"><path d="M235.08 182.37 C240.59 182.83, 247.84 186.7, 259.08 189.38 M235.08 182.37 C243.54 184.78, 250.89 186.7, 259.08 189.38" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1347.8886360299377 87.43306315271002) rotate(0 128.7063010379428 95.11709564511375)"><path d="M245.2 168.58 C248.36 172.32, 253.21 179.46, 259.08 189.38 M245.2 168.58 C250.25 175.65, 254.23 182.16, 259.08 189.38" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1495.4300055124577 273.2724051392029) rotate(0 -68.43408201529644 -69.68975324493476)"><path d="M0.7 -0.4 C-21.92 -23.72, -113.45 -117.15, -136.36 -140.15 M-0.4 -1.66 C-23.07 -24.83, -114.2 -115.92, -137.04 -139.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1495.4300055124577 273.2724051392029) rotate(0 -68.43408201529644 -69.68975324493476)"><path d="M-114.4 -128.39 C-120.62 -130.02, -126.79 -133.23, -137.04 -139.01 M-114.4 -128.39 C-122.63 -132.1, -130.91 -135.66, -137.04 -139.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1495.4300055124577 273.2724051392029) rotate(0 -68.43408201529644 -69.68975324493476)"><path d="M-126.53 -116.33 C-129.74 -120.99, -132.93 -127.17, -137.04 -139.01 M-126.53 -116.33 C-130.18 -124.63, -133.82 -132.81, -137.04 -139.01" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round" transform="translate(1116.8451234895779 331.6611173173917) rotate(0 80.36295869686182 45.831999881803995)"><path d="M22.92 0 C65.31 0.14, 112.28 -0.34, 137.81 0 M22.92 0 C54.91 -1.15, 87.33 -0.42, 137.81 0 M137.81 0 C153.28 0.07, 161.76 5.69, 160.73 22.92 M137.81 0 C152.99 -2.06, 158.8 5.82, 160.73 22.92 M160.73 22.92 C162.65 38.68, 160.38 52.68, 160.73 68.75 M160.73 22.92 C160.59 33.49, 161.12 42.83, 160.73 68.75 M160.73 68.75 C161.74 84.33, 153.94 92.85, 137.81 91.66 M160.73 68.75 C162.91 82.38, 154.5 92.63, 137.81 91.66 M137.81 91.66 C103.63 92.74, 68.18 91.25, 22.92 91.66 M137.81 91.66 C110.78 90.04, 83.27 91.27, 22.92 91.66 M22.92 91.66 C9.03 91.28, 0.73 83.54, 0 68.75 M22.92 91.66 C5.4 90.13, -1.78 82.34, 0 68.75 M0 68.75 C0.31 59.17, -1.05 47.77, 0 22.92 M0 68.75 C0.08 55.37, 0.75 43.87, 0 22.92 M0 22.92 C-0.36 8.9, 6.4 -0.14, 22.92 0 M0 22.92 C1.23 6.57, 5.47 2.29, 22.92 0" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1146.7881297938616 364.9931171991957) rotate(0 50.419952392578125 12.5)"><text x="50.419952392578125" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="middle" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">flink/spark</text></g><g stroke-linecap="round"><g transform="translate(776.5582202575536 559.5654454967732) rotate(0 172.34087626787948 -96.3727668747523)"><path d="M1.19 1.08 C58.75 -30.81, 287.65 -159.32, 344.93 -191.57 M0.35 0.61 C57.82 -31.57, 286.8 -161.15, 344.11 -193.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(776.5582202575536 559.5654454967732) rotate(0 172.34087626787948 -96.3727668747523)"><path d="M327.82 -174.11 C333.96 -178.86, 338.4 -183.93, 344.11 -193.08 M327.82 -174.11 C332.73 -180.65, 338.26 -186.46, 344.11 -193.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(776.5582202575536 559.5654454967732) rotate(0 172.34087626787948 -96.3727668747523)"><path d="M319.45 -189.02 C327.76 -189.92, 334.42 -191.06, 344.11 -193.08 M319.45 -189.02 C327.24 -190.67, 335.51 -191.59, 344.11 -193.08" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1110.5667673413855 351.75185699160716) rotate(0 -182.3862461049871 106.73205451926958)"><path d="M0.97 -0.64 C-59.96 35.03, -304.31 178.35, -365.16 213.83 M0.02 1.64 C-61.14 36.95, -305.55 176.68, -366.31 211.9" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1110.5667673413855 351.75185699160716) rotate(0 -182.3862461049871 106.73205451926958)"><path d="M-350.21 192.77 C-356.71 198.69, -360.44 206.88, -366.31 211.9 M-350.21 192.77 C-352.63 197.25, -357.52 201.04, -366.31 211.9" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1110.5667673413855 351.75185699160716) rotate(0 -182.3862461049871 106.73205451926958)"><path d="M-341.68 207.6 C-351.02 208.6, -357.62 211.82, -366.31 211.9 M-341.68 207.6 C-345.75 209.17, -352.35 209.99, -366.31 211.9" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1265.642164201736 169.6795286940296) rotate(0 -11.614958874155832 79.7351230820426)"><path d="M0.17 -1.06 C-3.68 25.42, -20.2 132.52, -24.05 159.28 M-1.2 1 C-4.59 27.63, -18.05 134.08, -21.77 160.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1265.642164201736 169.6795286940296) rotate(0 -11.614958874155832 79.7351230820426)"><path d="M-27.17 136.31 C-27.66 140.33, -25.01 147.62, -21.77 160.72 M-27.17 136.31 C-26.21 142.94, -23.15 150.69, -21.77 160.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1265.642164201736 169.6795286940296) rotate(0 -11.614958874155832 79.7351230820426)"><path d="M-10.22 138.55 C-14.46 142.1, -15.57 148.9, -21.77 160.72 M-10.22 138.55 C-14.38 144.66, -16.42 151.74, -21.77 160.72" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g stroke-linecap="round"><g transform="translate(1258.1081368239052 322.2435830951031) rotate(0 10.045369837107728 -78.1655340449945)"><path d="M0.3 -0.65 C3.34 -26.96, 16.11 -130.64, 19.38 -156.77 M-1 1.63 C2.32 -24.01, 18.38 -129.07, 21.72 -155.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1258.1081368239052 322.2435830951031) rotate(0 10.045369837107728 -78.1655340449945)"><path d="M26.9 -131.01 C23.53 -141.93, 21.81 -150.78, 21.72 -155.47 M26.9 -131.01 C26.64 -136.56, 25.07 -142.01, 21.72 -155.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g><g transform="translate(1258.1081368239052 322.2435830951031) rotate(0 10.045369837107728 -78.1655340449945)"><path d="M9.97 -133.4 C13.37 -143.41, 18.39 -151.31, 21.72 -155.47 M9.97 -133.4 C13.19 -138.37, 15.09 -143.32, 21.72 -155.47" stroke="#1e1e1e" stroke-width="2" fill="none"></path></g></g><mask></mask><g transform="translate(1438.9247885030882 10) rotate(0 436.7596435546875 37.5)"><text x="0" y="0" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">another approach could be for realtime data (say few mins back use apache flink/spark</text><text x="0" y="25" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">spark/flink queries kafka</text><text x="0" y="50" font-family="Virgil, Segoe UI Emoji" font-size="20px" fill="#1e1e1e" text-anchor="start" style="white-space: pre;" direction="ltr" dominant-baseline="text-before-edge">and for older data (say a month, query the aggregated data store)</text></g></svg>